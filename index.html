<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Mídia Indoor</title>
  <style>
    body {
      margin: 0;
      background: black;
      color: white;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }
    #player {
      width: 100%;
      height: 80vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: black;
    }
    #infos {
      height: 20vh;
      padding: 10px;
      box-sizing: border-box;
      background: #111;
      font-size: 18px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    #news {
      margin-top: 10px;
      white-space: nowrap;
      overflow: hidden;
      box-sizing: border-box;
    }
    #news span {
      display: inline-block;
      padding-left: 100%;
      animation: marquee 30s linear infinite;
    }
    @keyframes marquee {
      from { transform: translateX(0%); }
      to { transform: translateX(-100%); }
    }
  </style>
</head>
<body>

  <div id="player"></div>

  <div id="infos">
    <div id="hora">Hora: --:--:--</div>
    <div id="tempo">Tempo: carregando...</div>
    <div id="megasena">Mega-Sena: carregando...</div>
    <div id="news"><span>Carregando notícias...</span></div>
  </div>

  <script>
    // -------------------------------
    // 1) Playlist de Anúncios
    // -------------------------------
    let playlist = [];
    let current = 0;

    async function loadPlaylist() {
      try {
        const res = await fetch("playlist.json");
        playlist = await res.json();
        playNext();
      } catch (e) {
        console.error("Erro carregando playlist", e);
      }
    }

    function playNext() {
      if (!playlist.length) return;

      const item = playlist[current];
      const player = document.getElementById("player");
      player.innerHTML = "";

      if (item.type === "video") {
        const video = document.createElement("video");
        video.src = item.src;
        video.autoplay = true;
        video.controls = false;
        video.muted = true;
        video.style.width = "100%";
        video.style.height = "100%";
        video.onended = () => {
          current = (current + 1) % playlist.length;
          playNext();
        };
        player.appendChild(video);

      } else if (item.type === "image") {
        const img = document.createElement("img");
        img.src = item.src;
        img.style.maxWidth = "100%";
        img.style.maxHeight = "100%";
        player.appendChild(img);
        setTimeout(() => {
          current = (current + 1) % playlist.length;
          playNext();
        }, (item.duration || 10) * 1000);
      }
    }

    loadPlaylist();

    // -------------------------------
    // 2) Relógio em tempo real
    // -------------------------------
    setInterval(() => {
      const agora = new Date();
      document.getElementById("hora").innerText =
        "Hora: " + agora.toLocaleTimeString();
    }, 1000);

    // -------------------------------
    // 3) Previsão do tempo (OpenWeatherMap)
    //    Troque "SUA_CHAVE_AQUI" pela sua API key gratuita
    // -------------------------------
   fetch("https://api.openweathermap.org/data/2.5/weather?lat=-22.9068&lon=-43.1729&units=metric&lang=pt_br&appid=c7296395a29b7135070ba6fd3c342cd0")
  .then(r => r.json())
  .then(dados => {
    document.getElementById("tempo").innerText =
      `Tempo: ${dados.weather[0].description}, ${dados.main.temp}°C`;
  })
  .catch(() => {
    document.getElementById("tempo").innerText = "Tempo: não disponível";
  });


    // -------------------------------
    // 4) Mega-Sena (último sorteio)
    // -------------------------------
    fetch("https://loteriascaixa-api.herokuapp.com/api/megasena/latest")
      .then(r => r.json())
  .then(dados => {
    document.getElementById("megasena").innerText =
      "Mega-Sena último sorteio: " + dados.dezenas.join(", ");
  })
  .catch(() => {
    document.getElementById("megasena").innerText = "Mega-Sena: não disponível";
  });

    // -------------------------------
    // 5) Notícias (usando RSS convertido em JSON via api.rss2json.com)
    // -------------------------------
    fetch("https://api.rss2json.com/v1/api.json?rss_url=https://g1.globo.com/rss/g1/")
      .then(r => r.json())
      .then(dados => {
        const manchetes = dados.items.slice(0, 5).map(n => n.title).join(" • ");
        document.getElementById("news").innerHTML = "<span>" + manchetes + "</span>";
      })
      .catch(() => {
        document.getElementById("news").innerHTML = "<span>Erro ao carregar notícias</span>";
      });

  </script>

</body>
</html>




